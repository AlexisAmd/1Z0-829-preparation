# Modules

## Example

module-info.java

```java
module zoo.animal.feeding {
  exports zoo.animal.feeding;
}
```

## compile

Extended Form

```java
javac--module-path mods
    -d feeding
    feeding/zoo/animal/feeding/*.java feeding/module-info.java
```

Abbreviated Form

```java
javac-p mods
    -d feeding
    feeding/zoo/animal/feeding/*.java feeding/module-info.java
```

## Running module

Extended Form

```java
java--module-path mods
    --module zoo.animal.feeding/zoo.animal.feeding.Task
```

Abbreviated Form

```java
java-p mods
    -m zoo.animal.feeding/zoo.animal.feeding.Task
```

## Module Declarations

**Packages inside a module are not exported by default.**  
exports to

```java
exports zoo.animal.talks.content to zoo.staff;
```

requires

```java
  requires zoo.animal.feeding;
```

requires transitive

```java
  requires transitive zoo.animal.care;
```

opens

```java
opens zoo.animal.talks.schedule;
    opens zoo.animal.talks.media to zoo.staff;
```

## Commands
### list
```java
$ java--list-modules
```
### jdeps
The jdeps command lists information about dependencies within a module.
```java
$ jdeps â€“s zoo.animal.puppy.jar 
```
### describe-module
```java
$ jar --file mods/talks-1.0.0-SNAPSHOT.jar --describe-module

    exports zoo.animal.talks.content
    exports zoo.animal.talks.media
    exports zoo.animal.talks.schedule
    requires java.base mandated
    requires zoo.animal.care
    requires zoo.animal.feeding
```
### jlink
```java
$ jlink-p feeding/target/--add-modules zoo.animal.feeding--output zooAPP
$ cd zooAPP/
$ ls
bin conf include legal lib man release
```

## Creating a service

### Service Provider Interface

interface

```java
public interface Tour {

  String name();
}
```

module

```java
// module-info.java
module zoo.tours.api {
  exports zoo.tours.api;
}
```

### Service Locator

A service locator can find any classes that implement a service provider interface.
Methods of ServiceLoader

```java
    public static List<Tour> findAllTours(){
        List<Tour> tours=new ArrayList<>();
        //ServiceLoader<T> defines an iterator
        ServiceLoader<Tour> loader=ServiceLoader.load(Tour.class);
        for(Tour tour:loader){
          tours.add(tour);
        }
        return tours;
    }
```

module-info of the Service Locator.

```java
// module-info.java
module zoo.tours.reservations {
  exports zoo.tours.reservations;
  requires zoo.tours.api;
  uses zoo.tours.api.Tour;
}
```

`zoo.tours.reservation` is the class containing the `ServiceLocator`.

### Service Provider Implementation

A service provider is the implementation of a service provider interface.

```java
public class TourImpl implements Tour {

  public String name() {
    return "service name";
  }
}

```

module

```java
// module-info.java
module zoo.tours.agency {
  requires zoo.tours.api;
  provides zoo.tours.api.Tour with zoo.tours.agency.TourImpl;
}
```

### Combining modules of a service

It is most logical to combine the **service locator** and s**ervice provider interface** because neither has
a direct reference to the service provider (implementation).

## Module Types

### Named Modules

A named module must be on the module path and contain a `module-info` file.

### Automatic Modules
An _automatic module_ appears on the module path but **does not contain** a `module-info` file.   
The rules for determining the name of `module-info`,  in an automatic module, 
include removing the extension and changing special characters to periods (.).

Example:  
Name of the jar: _cat-enrico2.jar_ --> `module-info` name: **cat.enrico2**

### Unnamed Modules
An _unnamed module_ appears on the classpath.  
Unlike an automatic module, it is on the classpath rather than the module path.

### Migration Strategies
- Bottom-Up Migration Strategy: 
- Top-Down Migration Strategy: starts by moving all the modules to the module path as automatic modules
## Resources

- www.selikoff.net/ocp-17/
- https://github.com/boyarsky/sybex-1Z0-829-chapter-12