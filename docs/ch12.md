# Modules

## compile
```java
javac --module-path mods
   -d feeding
   feeding/zoo/animal/feeding/*.java feeding/module-info.java
```
```java
javac -p mods
-d feeding
feeding/zoo/animal/feeding/*.java feeding/module-info.java
```

## Running module
```java
java --module-path mods
   --module zoo.animal.feeding/zoo.animal.feeding.Task
```

```java
java -p mods
    -m zoo.animal.feeding/zoo.animal.feeding.Task
```
## Module Declarations
**Packages inside a module are not exported by default.**  
exports to
```java
exports zoo.animal.talks.content to zoo.staff;
```
requires
```java
  requires zoo.animal.feeding;
```

requires transitive
```java
  requires transitive zoo.animal.care;
```
opens
```java
opens zoo.animal.talks.schedule;
opens zoo.animal.talks.media to zoo.staff;
```
## Commands
```java
$ java --list-modules
```
Describe module
```java
$ jar --file mods/talks-1.0.0-SNAPSHOT.jar --describe-module

exports zoo.animal.talks.content
exports zoo.animal.talks.media
exports zoo.animal.talks.schedule
requires java.base mandated
requires zoo.animal.care
requires zoo.animal.feeding
```

jlink
```java
$ jlink -p feeding/target/ --add-modules zoo.animal.feeding --output zooAPP
$ cd zooAPP/
$ ls
bin     conf    include legal   lib     man     release

```
## Creating a service

### Service Provider Interface
interface
```java
public interface Tour {
   String name();
}
```
module
```java
// module-info.java
module zoo.tours.api {
   exports zoo.tours.api;
}
```
### Service Locator
Methods of ServiceLoader
```java
    ServiceLoader<Tour> serviceLoader = ServiceLoader.load(Tour.class);
    Iterator<Tour> iterator = serviceLoader.iterator();
    //note here it returns a stream of provider!!
    Stream<Provider<Tour>> stream = serviceLoader.stream();
```

module-info of the Service Locator
```java
// module-info.java
module zoo.tours.reservations {
   exports zoo.tours.reservations;
   requires zoo.tours.api;
   uses zoo.tours.api.Tour;
}
```

### Service Provider Implementation
A service provider is the implementation of a service provider interface.
```java
public class TourImpl implements Tour {

  public String name() {
    return "service name";
  }
}

```
module
```java
// module-info.java
module zoo.tours.agency {
   requires zoo.tours.api;
   provides zoo.tours.api.Tour with zoo.tours.agency.TourImpl;
}
```




### Automatic Modules
An _automatic module_ appears on the module path but does not contain a **module-info.java** file.

### Unnamed Modules
An _unnamed module_ appears on the classpath.  
Unlike an automatic module, it is on the classpath rather than the module path. 

### Resources
- www.selikoff.net/ocp-17/
- https://github.com/boyarsky/sybex-1Z0-829-chapter-12